# RF07 - Gera√ß√£o de Autenticador para Receitas Virtuais

## Hist√≥ria de Usu√°rio ‚Äì Gera√ß√£o de Autenticador para Receita Virtual

**Como** m√©dico prescriptor,  
**Quero** que o sistema gere automaticamente um autenticador √∫nico ao emitir uma receita virtual,  
**Para que** a autenticidade da receita possa ser validada por pacientes e farm√°cias, garantindo seguran√ßa e conformidade legal.

### ‚úÖ Crit√©rios de Aceita√ß√£o

- O sistema deve gerar automaticamente um autenticador √∫nico (alfanum√©rico de 8 caracteres) ao emitir uma receita virtual.
- O autenticador deve ser vinculado √† receita e ao paciente, armazenado no banco de dados.
- Apenas prescritores autenticados podem emitir receitas virtuais com autenticador.
- O autenticador deve ser disponibilizado junto √† receita na √°rea do paciente.
- Farm√°cias/sistemas externos devem poder consultar a validade do autenticador por meio de um endpoint/API.
- O sistema deve rejeitar autenticadores duplicados ou inv√°lidos.
- O autenticador deve ser v√°lido por at√© 30 dias ap√≥s a data de emiss√£o.
- Autenticadores expirados ou inv√°lidos devem ser rejeitados pela API de valida√ß√£o.
- O sistema deve exibir uma mensagem de erro caso haja falha na gera√ß√£o do autenticador.

### üìå Cen√°rios

**Cen√°rio 1: Emiss√£o bem-sucedida de receita virtual com autenticador**  
**Dado que** estou autenticado como m√©dico prescriptor  
**Quando** emito uma receita virtual pelo sistema  
**Ent√£o** o sistema deve gerar automaticamente um c√≥digo autenticador √∫nico (alfanum√©rico, 8 caracteres)  
**E** associar esse autenticador √† receita e ao paciente  
**E** disponibilizar o autenticador junto √† receita na √°rea do paciente.

**Cen√°rio 2: Valida√ß√£o do autenticador por farm√°cia ou sistema externo**  
**Dado que** uma farm√°cia ou sistema externo possui um c√≥digo autenticador  
**Quando** consulta a API/endpoint de valida√ß√£o informando o autenticador  
**Ent√£o** o sistema deve retornar se o autenticador est√° "v√°lido" ou "inv√°lido"  
**E** rejeitar c√≥digos duplicados, inexistentes ou expirados.

**Cen√°rio 3: Expira√ß√£o do autenticador**  
**Dado que** um autenticador foi gerado h√° mais de 30 dias  
**Quando** a farm√°cia ou sistema externo tenta validar esse autenticador  
**Ent√£o** o sistema deve rejeitar e retornar que o autenticador est√° expirado ou inv√°lido.

**Cen√°rio 4: Tentativa de emiss√£o por usu√°rio n√£o autenticado**  
**Dado que** n√£o estou autenticado como m√©dico prescriptor  
**Quando** tento emitir uma receita virtual  
**Ent√£o** o sistema deve impedir a gera√ß√£o do autenticador  
**E** exibir uma mensagem informando que somente prescritores autenticados podem emitir receitas virtuais.
